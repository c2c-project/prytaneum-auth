version: 2.1
orbs:
#   node: circleci/node@2.1.0
jobs:
  build-and-test:
    docker:
        - image: circleci/node:latest
        - image: circleci/mongo:latest
    steps:
        - checkout
        - run:
            name: Setup Env Vars
            command: cat .env.example >> $BASH_ENV
        - restore_cache:
            key: dependency-cache-{{ checksum "yarn.lock" }}
        - run:
            name: install
            command: yarn install
        - save_cache:
            key: dependency-cache-{{ checksum "yarn.lock" }}
            paths:
                - node_modules
        - run: yarn test
workflows:
    build-and-test:
      jobs:
        - build-and-test